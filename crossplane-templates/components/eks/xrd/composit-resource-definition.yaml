apiVersion: apiextensions.crossplane.io/v1
kind: CompositeResourceDefinition
metadata:
  name: xcluanys.eks.anycompany.com
  labels:
    idp: "true"
spec:
  group: eks.anycompany.com
  names:
    kind: XCluany
    plural: xcluanys
  claimNames:
    kind: Cluster
    plural: clusters
  connectionSecretKeys:
  - kubeconfig
  - value
  defaultCompositionRef:
    name: xcluanys
  versions:
  - name: v1alpha1
    served: true
    referenceable: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              id:
                type: string
                description: ID of this Cluster that other objects can refer.
              parameters:
                type: object
                description: Parameters used to customize the cluster
                properties:
                  region:
                    description: Geographic location of this VPC
                    type: string
                    enum: ["us-east-1", "us-west-2"]
                    default: "us-east-1"
                  version:
                    description: The Kubernetes version for the cluster.
                    type: string
                  nodeSize:
                    description: The size of the nodes; small, medium, large.
                    type: string
                  minNodeCount:
                    description: The minimum number of nodes.
                    type: integer
                    default: 2
                  vpc:
                    type: object
                    description: Network resources for the cluster.
                    properties:
                      vpcID:
                        description: VPC ID
                        type: string
                      subnets-private-id:
                        description: Ids for private subnets
                        type: array
                        items:
                          type: string
                    required:
                    - vpcID
                    - subnets-private-id
                  namespaces:
                    description: List of Namespaces that should be created in the cluster
                    type: array
                    items:
                      type: string
                    default:
                      - dev
                      - production
                  iam:
                    type: object
                    description: List of IAM permissions
                    properties:
                      roleArnAdmin:
                        description: Cluster Group Admin
                        type: string
                        default: "arn:aws:iam::787843526639:role/AWSReservedSSO_EKSClusterAdmin_b2a81c854dd698ec"
                  apps:
                    type: object
                    description: List of apps that should be installed in the cluster
                    properties:
                      crossplane:
                        type: object
                        description: Install Crossplane
                        properties:
                          enabled:
                            type: boolean
                            default: false
                      argocd:
                        type: object
                        description: Install Argocd
                        properties:
                          enabled:
                            type: boolean
                            default: false
                required:
                - region
                - version
                - vpc
                - nodeSize
            required:
            - id
            - parameters
          status:
            type: object
            description: Status represents the observed state
            properties:
              clusterName:
                description: The name of the cluster.
                type: string
              controlPlaneStatus:
                description: The status of the control plane.
                type: string
              nodePoolStatus:
                description: The status of the node pool.
                type: string
              eks:
                description: Freeform field containing status information for EKS Cluster
                type: object
                x-kubernetes-preserve-unknown-fields: true
              karpenter:
                description: Freeform field containing status information for karpenter
                type: object
                x-kubernetes-preserve-unknown-fields: true
              albcontroller:
                description: Freeform field containing status information for alb controller
                type: object
                x-kubernetes-preserve-unknown-fields: true
              crossplane:
                description: Freeform field containing status information for alb controller
                type: object
                x-kubernetes-preserve-unknown-fields: true
    additionalPrinterColumns:
    - name: clusterName
      type: string
      jsonPath: ".status.clusterName"
    - name: controlPlane
      type: string
      jsonPath: ".status.controlPlaneStatus"
    - name: nodePool
      type: string
      jsonPath: ".status.nodePoolStatus"
